<h1 class='mt-2 mb-2'>Collabs</h1>

<div class="card-columns">
<% @collabs.each do |collab, count| %>
  <div class="card" >
    <div class="card-header">
      <h3 class=m-0>
        <img src="https://github.com/<%= collab %>.png" class="rounded" height='30'>
        <%= collab %>
        <%= link_to octicon('mark-github'), "https://"+collab, target: :_blank %>
      </h3>
    </div>

    <ul class="list-group list-group-flush">
      <li class="list-group-item pt-2 pb-2">
        <%= octicon('issue-opened') %> Issues
        <small class='text-muted'><%= number_with_delimiter @scope.collab(collab).select(:html_url).reject(&:pull_request?).length %></small>
      </li>
      <li class="list-group-item pt-2 pb-2">
        <%= octicon('git-pull-request') %> Pull Requests
        <small class='text-muted'><%= number_with_delimiter @scope.collab(collab).select(:html_url).select(&:pull_request?).length %></small>
      </li>
      <li class="list-group-item pt-2 pb-2">
        <%= octicon('person') %> Unique Contributors
        <small class='text-muted'><%= number_with_delimiter  @scope.collab(collab).group(:user).count.length %></small>

      </li>
    </ul>

    <div class="card-header">
      Related collabs
    </div>
    <% related_collabs = @scope.collab(collab).pluck(:collabs).flatten.inject(Hash.new(0)) { |h, e| h[e] += 1 ; h }.sort_by{|k,v| -v}.reject{|k,v| k == collab } %>
    <ul class="list-group list-group-flush">
      <%  related_collabs.each do |related_collab, count| %>
        <li class="list-group-item pt-2 pb-2">
          <img src="https://github.com/<%= related_collab %>.png" class="rounded" height='20'>
          <%= related_collab %>
          <small class='text-muted'><%= number_with_delimiter count %></small>
        </li>
      <% end %>
    </ul>
  </div>
<% end %>
</div>
