<% direct_internal_dependencies = @repository.direct_internal_dependencies.includes(:manifest) %>
<% if direct_internal_dependencies.present? %>
  <% @repository.direct_internal_dependencies.group_by(&:manifest).sort_by{|m,d| m.filepath }.each do |manifest, deps| %>
    <div class="card mb-3">
      <div class="card-header">
        <%= link_to manifest.filepath, manifest.repository_link, target: :_blank %>
      </div>
      <ul class="list-group list-group-flush">
        <% deps.each do |dependency| %>
          <li class="list-group-item">
            <% if dependency.package %>
              <%= link_to dependency.package_name, package_url(dependency.package.id) %>
            <% else %>
              <%= dependency.package_name %>
            <% end %>
            <%= dependency.requirements %>
            <small class='text-muted'>
            <% if dependency.kind != 'runtime' %>
              <%= dependency.kind %>
            <% end %>
            <% if dependency.optional %>
              (optional)
            <% end %>
            </small>
          </li>
        <% end %>
      </ul>
    </div>
  <% end %>
<% else %>
  <p>No internal direct dependencies found</p>
<% end %>
